kind: secret
name: keycloak-cache-config
description: keycloak-cache-config
tags: {}
type: opaque
data:
  encoding: plain
  payload: >+
    <infinispan                                                                                                                        
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"                                                                                       
            xsi:schemaLocation="urn:infinispan:config:11.0 http://www.infinispan.org/schemas/infinispan-config-11.0.xsd"                                
            xmlns="urn:infinispan:config:11.0">                                                                                                                        
                                                                                                                            
        <jgroups>                                                                                                               
          <stack name="tcpping" extends="tcp"> 
            <TCP bind_port="7800"/>                                                                                                                       
            <TCPPING             
              initial_hosts="keycloak-stateful-0.keycloak-stateful[7800],keycloak-stateful-1.keycloak-stateful[7800]"                                   
              port_range="0"                                                                                                                                 
              stack.combine="REPLACE"                                                                                                                        
              stack.position="MPING"                                                                                                                        
              />                                                                                                                        
          </stack>                                                                                                                        
        </jgroups>  

        <cache-container name="keycloak" statistics="true">
            <transport lock-timeout="60000" stack="tcpping"/>
            <local-cache name="realms">
                <encoding>
                    <key media-type="application/x-java-object"/>
                    <value media-type="application/x-java-object"/>
                </encoding>
                <memory max-count="10000"/>
            </local-cache>
            <local-cache name="users">
                <encoding>
                    <key media-type="application/x-java-object"/>
                    <value media-type="application/x-java-object"/>
                </encoding>
                <memory max-count="20000"/>
            </local-cache>
            <distributed-cache name="sessions" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <distributed-cache name="authenticationSessions" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <distributed-cache name="offlineSessions" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <distributed-cache name="clientSessions" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <distributed-cache name="offlineClientSessions" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <distributed-cache name="loginFailures" owners="2">
                <expiration lifespan="-1"/>
            </distributed-cache>
            <local-cache name="authorization">
                <encoding>
                    <key media-type="application/x-java-object"/>
                    <value media-type="application/x-java-object"/>
                </encoding>
                <memory max-count="20000"/>
            </local-cache>
            <replicated-cache name="work">
                <expiration lifespan="-1"/>
            </replicated-cache>
            <local-cache name="keys">
                <encoding>
                    <key media-type="application/x-java-object"/>
                    <value media-type="application/x-java-object"/>
                </encoding>
                <expiration max-idle="3600000"/>
                <memory max-count="1000"/>
            </local-cache>
            <distributed-cache name="actionTokens" owners="2">
                <encoding>
                    <key media-type="application/x-java-object"/>
                    <value media-type="application/x-java-object"/>
                </encoding>
                <expiration max-idle="-1" lifespan="-1" interval="300000"/>
                <memory max-count="-1"/>
            </distributed-cache>
        </cache-container>
    </infinispan>

